# Generated by Django 5.2.7 on 2026-02-05 19:02

import django.core.validators
import django.db.models.deletion
import netbox.models.deletion
import taggit.managers
import utilities.json
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('dcim', '0215_rackreservation_status'),
        ('extras', '0133_make_cf_minmax_decimal'),
        ('ipam', '0082_add_prefix_network_containment_indexes'),
        ('virtualization', '0048_populate_mac_addresses'),
    ]

    operations = [
        migrations.CreateModel(
            name='Image',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False)),
                ('created', models.DateTimeField(auto_now_add=True, null=True)),
                ('last_updated', models.DateTimeField(auto_now=True, null=True)),
                ('custom_field_data', models.JSONField(blank=True, default=dict, encoder=utilities.json.CustomFieldJSONEncoder)),
                ('registry', models.CharField(max_length=255, validators=[django.core.validators.RegexValidator(message='Registry must be a hostname (optionally with port). Example: registry-1.docker.io or quay.io', regex='^[a-z0-9][a-z0-9.-]*(:\\d+)?$')])),
                ('name', models.CharField(max_length=255)),
                ('default_tag', models.CharField(blank=True, default='latest', max_length=128)),
                ('comments', models.TextField(blank=True)),
                ('tags', taggit.managers.TaggableManager(through='extras.TaggedItem', to='extras.Tag')),
            ],
            options={
                'verbose_name': 'Image',
                'verbose_name_plural': 'Images',
                'ordering': ('registry', 'name', 'pk'),
            },
            bases=(netbox.models.deletion.DeleteMixin, models.Model),
        ),
        migrations.CreateModel(
            name='ImageTag',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False)),
                ('created', models.DateTimeField(auto_now_add=True, null=True)),
                ('last_updated', models.DateTimeField(auto_now=True, null=True)),
                ('custom_field_data', models.JSONField(blank=True, default=dict, encoder=utilities.json.CustomFieldJSONEncoder)),
                ('image_tag', models.CharField(blank=True, default='latest', max_length=128)),
                ('os', models.CharField(blank=True, max_length=32)),
                ('arch', models.CharField(blank=True, max_length=32)),
                ('digest', models.CharField(blank=True, max_length=128)),
                ('size', models.BigIntegerField(blank=True, null=True)),
                ('comments', models.TextField(blank=True)),
                ('image', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='image_tags', to='netbox_containers.image')),
                ('tags', taggit.managers.TaggableManager(through='extras.TaggedItem', to='extras.Tag')),
            ],
            options={
                'verbose_name': 'Image Tag',
                'verbose_name_plural': 'Image Tags',
                'ordering': ('image__registry', 'image__name', 'image_tag', 'arch', 'os', 'digest', 'size', 'pk'),
            },
            bases=(netbox.models.deletion.DeleteMixin, models.Model),
        ),
        migrations.CreateModel(
            name='Container',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False)),
                ('created', models.DateTimeField(auto_now_add=True, null=True)),
                ('last_updated', models.DateTimeField(auto_now=True, null=True)),
                ('custom_field_data', models.JSONField(blank=True, default=dict, encoder=utilities.json.CustomFieldJSONEncoder)),
                ('name', models.CharField(max_length=100)),
                ('status', models.CharField(max_length=20)),
                ('user', models.CharField(blank=True, max_length=100, null=True)),
                ('published_ports', models.TextField(blank=True)),
                ('comments', models.TextField(blank=True)),
                ('command', models.CharField(blank=True, max_length=200, null=True)),
                ('user_namespaces', models.CharField(blank=True, max_length=100, null=True)),
                ('memory_limit', models.CharField(blank=True, max_length=16, validators=[django.core.validators.RegexValidator(message='Enter a positive number optionally followed by b, k, m, or g (e.g. 512m, 1g, 1048576).', regex='^[1-9]\\d*(?:[bBkKmMgG])?$')])),
                ('cpu_limit', models.DecimalField(blank=True, decimal_places=3, max_digits=6, null=True)),
                ('environment', models.JSONField(blank=True, default=list)),
                ('add_host', models.JSONField(blank=True, default=list)),
                ('is_infra', models.BooleanField(default=False)),
                ('devices', models.ManyToManyField(blank=True, related_name='container_containers', to='dcim.device')),
                ('tags', taggit.managers.TaggableManager(through='extras.TaggedItem', to='extras.Tag')),
                ('virtual_machines', models.ManyToManyField(blank=True, related_name='container_containers', to='virtualization.virtualmachine')),
                ('image_tag', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='containers', to='netbox_containers.imagetag')),
            ],
            options={
                'verbose_name': 'Container',
                'verbose_name_plural': 'Containers',
                'ordering': ('name', 'pk'),
            },
            bases=(netbox.models.deletion.DeleteMixin, models.Model),
        ),
        migrations.CreateModel(
            name='Network',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False)),
                ('created', models.DateTimeField(auto_now_add=True, null=True)),
                ('last_updated', models.DateTimeField(auto_now=True, null=True)),
                ('custom_field_data', models.JSONField(blank=True, default=dict, encoder=utilities.json.CustomFieldJSONEncoder)),
                ('name', models.CharField(max_length=100)),
                ('driver', models.CharField(max_length=20)),
                ('user', models.CharField(blank=True, max_length=100, null=True)),
                ('subnets_text', models.JSONField(blank=True, default=list)),
                ('label', models.CharField(blank=True, max_length=100, null=True)),
                ('gateway', models.GenericIPAddressField(blank=True, null=True)),
                ('comments', models.TextField(blank=True)),
                ('devices', models.ManyToManyField(blank=True, related_name='container_networks', to='dcim.device')),
                ('prefixes', models.ManyToManyField(blank=True, related_name='container_networks', to='ipam.prefix')),
                ('tags', taggit.managers.TaggableManager(through='extras.TaggedItem', to='extras.Tag')),
                ('virtual_machines', models.ManyToManyField(blank=True, related_name='container_networks', to='virtualization.virtualmachine')),
            ],
            options={
                'verbose_name': 'Network',
                'verbose_name_plural': 'Networks',
                'ordering': ('name', 'pk'),
            },
            bases=(netbox.models.deletion.DeleteMixin, models.Model),
        ),
        migrations.CreateModel(
            name='Pod',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False)),
                ('created', models.DateTimeField(auto_now_add=True, null=True)),
                ('last_updated', models.DateTimeField(auto_now=True, null=True)),
                ('custom_field_data', models.JSONField(blank=True, default=dict, encoder=utilities.json.CustomFieldJSONEncoder)),
                ('name', models.CharField(max_length=100)),
                ('status', models.CharField(max_length=20)),
                ('user', models.CharField(blank=True, max_length=100, null=True)),
                ('published_ports', models.TextField(blank=True)),
                ('comments', models.TextField(blank=True)),
                ('add_host', models.JSONField(blank=True, default=list)),
                ('devices', models.ManyToManyField(blank=True, related_name='container_pods', to='dcim.device')),
                ('infra_container', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='infra_for_pods', to='netbox_containers.container')),
                ('tags', taggit.managers.TaggableManager(through='extras.TaggedItem', to='extras.Tag')),
                ('virtual_machines', models.ManyToManyField(blank=True, related_name='container_pods', to='virtualization.virtualmachine')),
            ],
            options={
                'verbose_name': 'Pod',
                'verbose_name_plural': 'Pods',
                'ordering': ('name', 'pk'),
            },
            bases=(netbox.models.deletion.DeleteMixin, models.Model),
        ),
        migrations.CreateModel(
            name='NetworkAttachment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False)),
                ('created', models.DateTimeField(auto_now_add=True, null=True)),
                ('last_updated', models.DateTimeField(auto_now=True, null=True)),
                ('custom_field_data', models.JSONField(blank=True, default=dict, encoder=utilities.json.CustomFieldJSONEncoder)),
                ('mode', models.CharField(default='network', max_length=16)),
                ('options', models.CharField(blank=True, max_length=255)),
                ('container', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='network_attachments', to='netbox_containers.container')),
                ('network', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='attachments', to='netbox_containers.network')),
                ('tags', taggit.managers.TaggableManager(through='extras.TaggedItem', to='extras.Tag')),
                ('pod', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='network_attachments', to='netbox_containers.pod')),
            ],
            options={
                'verbose_name': 'Network Attachment',
                'verbose_name_plural': 'Network Attachments',
                'ordering': ('pk',),
            },
            bases=(netbox.models.deletion.DeleteMixin, models.Model),
        ),
        migrations.AddField(
            model_name='container',
            name='pod',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='containers', to='netbox_containers.pod'),
        ),
        migrations.CreateModel(
            name='Secret',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False)),
                ('created', models.DateTimeField(auto_now_add=True, null=True)),
                ('last_updated', models.DateTimeField(auto_now=True, null=True)),
                ('custom_field_data', models.JSONField(blank=True, default=dict, encoder=utilities.json.CustomFieldJSONEncoder)),
                ('name', models.CharField(max_length=100)),
                ('driver', models.CharField(max_length=20)),
                ('options', models.TextField(blank=True)),
                ('tags', taggit.managers.TaggableManager(through='extras.TaggedItem', to='extras.Tag')),
            ],
            options={
                'verbose_name': 'Secret',
                'verbose_name_plural': 'Secrets',
                'ordering': ('name', 'pk'),
            },
            bases=(netbox.models.deletion.DeleteMixin, models.Model),
        ),
        migrations.CreateModel(
            name='ContainerSecret',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False)),
                ('created', models.DateTimeField(auto_now_add=True, null=True)),
                ('last_updated', models.DateTimeField(auto_now=True, null=True)),
                ('custom_field_data', models.JSONField(blank=True, default=dict, encoder=utilities.json.CustomFieldJSONEncoder)),
                ('type', models.CharField(max_length=16)),
                ('target', models.CharField(max_length=255)),
                ('uid', models.PositiveIntegerField(blank=True, null=True)),
                ('gid', models.PositiveIntegerField(blank=True, null=True)),
                ('mode', models.CharField(blank=True, max_length=8)),
                ('container', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='secrets', to='netbox_containers.container')),
                ('tags', taggit.managers.TaggableManager(through='extras.TaggedItem', to='extras.Tag')),
                ('secret', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='container_secrets', to='netbox_containers.secret')),
            ],
            options={
                'verbose_name': 'Container Secret',
                'verbose_name_plural': 'Container Secrets',
                'ordering': ('container_id', 'pk'),
            },
            bases=(netbox.models.deletion.DeleteMixin, models.Model),
        ),
        migrations.CreateModel(
            name='Volume',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False)),
                ('created', models.DateTimeField(auto_now_add=True, null=True)),
                ('last_updated', models.DateTimeField(auto_now=True, null=True)),
                ('custom_field_data', models.JSONField(blank=True, default=dict, encoder=utilities.json.CustomFieldJSONEncoder)),
                ('name', models.CharField(max_length=100)),
                ('driver', models.CharField(max_length=20)),
                ('options', models.CharField(blank=True, max_length=100, null=True)),
                ('label', models.CharField(blank=True, max_length=100, null=True)),
                ('comments', models.TextField(blank=True)),
                ('tags', taggit.managers.TaggableManager(through='extras.TaggedItem', to='extras.Tag')),
            ],
            options={
                'verbose_name': 'Volume',
                'verbose_name_plural': 'Volumes',
                'ordering': ('name', 'pk'),
            },
            bases=(netbox.models.deletion.DeleteMixin, models.Model),
        ),
        migrations.CreateModel(
            name='Mount',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False)),
                ('created', models.DateTimeField(auto_now_add=True, null=True)),
                ('last_updated', models.DateTimeField(auto_now=True, null=True)),
                ('custom_field_data', models.JSONField(blank=True, default=dict, encoder=utilities.json.CustomFieldJSONEncoder)),
                ('mount_type', models.CharField(default='volume', max_length=16)),
                ('host_path', models.CharField(blank=True, max_length=512)),
                ('dest_path', models.CharField(max_length=512, validators=[django.core.validators.RegexValidator(message='Destination path must be an absolute path inside the container (e.g. /var/lib/pgsql/data).', regex='^/.*')])),
                ('options', models.CharField(blank=True, max_length=255, validators=[django.core.validators.RegexValidator(message='Options must be a comma-separated list (e.g. ro,Z,rshared,uid=1000).', regex='^[A-Za-z0-9=,_:+.\\-]*$')])),
                ('container', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='mounts', to='netbox_containers.container')),
                ('tags', taggit.managers.TaggableManager(through='extras.TaggedItem', to='extras.Tag')),
                ('volume', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='mounts', to='netbox_containers.volume')),
            ],
            options={
                'verbose_name': 'Mount',
                'verbose_name_plural': 'Mounts',
                'ordering': ('container_id', 'pk'),
            },
            bases=(netbox.models.deletion.DeleteMixin, models.Model),
        ),
        migrations.AddConstraint(
            model_name='image',
            constraint=models.UniqueConstraint(fields=('registry', 'name'), name='uniq_image_registry_name'),
        ),
        migrations.AddConstraint(
            model_name='imagetag',
            constraint=models.UniqueConstraint(fields=('image', 'image_tag', 'os', 'arch'), name='uniq_imagetag_variants_per_image'),
        ),
    ]
